# Host discovery

```sh
# NMAP
sudo nmap 10.5.5.0/24 -PE -sn

# Bash
for i in {1..255}; do ping -c 1 -W 1 10.5.5.$i | grep '64 bytes' | cut -d" " -f 4 | tr -d ":"; done

# CMD
for /L %i IN (1,1,255) do @ping -n 1 -w 1000 10.5.5.%i > null && echo 10.5.5.%i is up.

# DNS (Host)
for i in {1..255}; do host 10.5.5.$i SERVER; done | grep -v "not found"

# DNS (Dig)
for i in {1..255}; do dig +timeout=1 +noall +answer -x 10.5.5.$i @SERVER; done
```

# Port discovery

```sh
# NMAP
sudo nmap 10.5.5.5 -p- -n -Pn -sS -T5 --reason --open -vvvv

# Netcat (TCP)
nc -n -z -v -w 1 10.5.5.5 1-65535 2>&1 | grep open

# Netcat (UDP)
nc -u -n -z -v -w 1 10.5.5.5 1-65535 2>&1 | grep open

# Powershell (TCP)
$ip = "10.5.5.5"; foreach ($i in (1..65535)) { $s = New-Object System.Net.Sockets.TcpClient; try { $c = $s.ConnectAsync($ip, $i); for ($t = 10; --$t -gt 0;) { if ($c.isCompleted) { break; } Start-Sleep -milliseconds 100; } if ($s.Connected) { Write-Host "$i is open" } } finally { $s.Dispose() } }
```

# Service discovery

```sh
# NMAP
nmap 10.5.5.5 -p 80,443,3306 -n -Pn -sV -T5 --version-all --script default,auth,brute,discovery,vuln
```

## Banner grab manually

```sh
# Netcat banners (LF line ending)
nc -nv 10.5.5.5 80

# Netcat banners CRLF line ending
nc -nvc 10.5.5.5 80
```

# vHost discovery

```sh
# Firstly you need the response length of a false positive
curl -s -H 'Host: nonexistent.ledomain.local' http://10.5.5.5 | wc -c

# Secondly, you need the status code of a false positive
curl -s -o /dev/null -w "%{http_code}" -H 'Host: nonexistent.ledomain.local' http://10.5.5.5

# FFuF (`-fs` and `-fc` to exclude false positive)
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://10.5.5.5/ -H 'Host: FUZZ.ledomain.local' -fs 11952 -fc 200 -mc all
```

# Whois information

```sh
# Retrieve whois information
whois uqat.ca
```