# Pentest Cheatsheet



1. Host discovery
	1. Remote
		1. NMAP<br>`sudo nmap 10.5.5.0/24 -PE -sn`
		1. Bash<br>`for i in {1..255}; do ping -c 1 -W 1 10.5.5.$i | grep '64 bytes' | cut -d" " -f 4 | tr -d ":"; done`
		1. CMD<br>`for /L %i IN (1,1,255) do @ping -n 1 -w 1000 10.5.5.%i > null && echo 10.5.5.%i is up.`
		1. DNS records (host)<br>`for i in {1..255}; do host 10.5.5.$i SERVER; done | grep -v "not found"`
		1. DNS records (dig)<br>`for i in {1..255}; do dig +timeout=1 +noall +answer -x 10.5.5.$i @SERVER; done`
	1. Local
		1. Docker<br>`docker ps -a`
1. Port discovery
	1. Remote
		1. NMAP<br>`nmap 10.5.5.0/24 -p- -n -Pn -sS -T3 --reason --open`
		1. NC (TCP)<br>`nc -n -z -v -w 1 192.168.234.171 1-65535 2>&1 | grep open`
		1. NC (UDP)<br>`nc -u -n -z -v -w 1 192.168.234.171 1-65535 2>&1 | grep open`
		1. Powershell<br>`$ip = "192.168.234.171"; foreach ($i in (1..65535)) { $s = New-Object System.Net.Sockets.TcpClient; try { $c = $s.ConnectAsync($ip, $i); for ($t = 10; --$t -gt 0;) { if ($c.isCompleted) { break; } Start-Sleep -milliseconds 100; } if ($s.Connected) { Write-Host "$i is open" } } finally { $s.Dispose() } }`
	1. Local
		1. Netstat (linux)<br>`netstat -natup`
		1. Netstat (window)<br>`netstat -ano`
		1. Bash (linux)<br>`awk 'function hextodec(str,ret,n,i,k,c){ret = 0;n = length(str);for (i = 1; i <= n; i++) {c = tolower(substr(str, i, 1));k = index("123456789abcdef", c);ret = ret * 16 + k;}return ret;}function getIP(str,ret){ret=hextodec(substr(str,index(str,":")-2,2));for (i=5; i>0; i-=2) {ret = ret"."hextodec(substr(str,i,2));}    ret = ret":"hextodec(substr(str,index(str,":")+1,4));return ret;} NR > 1 {{if(NR==2)print "Local - Remote";local=getIP($2);remote=getIP($3)}{print local" - "remote}}' /proc/net/tcp`