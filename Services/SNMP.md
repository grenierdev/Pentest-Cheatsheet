# SNMP

Ports: `161 (UDP)`

## NMAP scan
```sh
┌──(grenierdev㉿kali)-[~]
└─$ sudo nmap -n -sU -T3 --reason 10.11.1.0/24 -p161 --open -oG - | grep "Ports: " | awk '{print $2}' | tee snmphosts
10.11.1.14
10.11.1.31
10.11.1.50
10.11.1.73
10.11.1.79
10.11.1.115
10.11.1.133
10.11.1.141
10.11.1.146
10.11.1.221
10.11.1.227
10.11.1.250
10.11.1.251
10.11.1.252

# NMAP scripts
┌──(grenierdev㉿kali)-[~]
└─$ for s in $(locate .nse | grep "snmp"); do echo -n $s "\t" && echo $(cat $s | grep -oh -P -z "(?Us)description\s*=\s*\[\[\s*\K.*\]\]" | tr -d '\n' | head -c 100); done
/usr/share/nmap/scripts/snmp-brute.nse  Attempts to find an SNMP community string by brute force guessing.This script opens a sending socket
/usr/share/nmap/scripts/snmp-hh3c-logins.nse    Attempts to enumerate Huawei / HP/H3C Locally Defined Users through thehh3c-user.mib OIDFor devices
/usr/share/nmap/scripts/snmp-info.nse   Extracts basic information from an SNMPv3 GET request. The same probe is usedhere as in the service
/usr/share/nmap/scripts/snmp-interfaces.nse     Attempts to enumerate network interfaces through SNMP.This script can also be run during Nmap's pre-
/usr/share/nmap/scripts/snmp-ios-config.nse     Attempts to downloads Cisco router IOS configuration files using SNMP RW (v1) and display or save th
/usr/share/nmap/scripts/snmp-netstat.nse        Attempts to query SNMP for a netstat like output. The script can be used toidentify and automaticall
/usr/share/nmap/scripts/snmp-processes.nse      Attempts to enumerate running processes through SNMP.]] 
/usr/share/nmap/scripts/snmp-sysdescr.nse       Attempts to extract system information from an SNMP service.]] 
/usr/share/nmap/scripts/snmp-win32-services.nse         Attempts to enumerate Windows services through SNMP.]] 
/usr/share/nmap/scripts/snmp-win32-shares.nse   Attempts to enumerate Windows Shares through SNMP.]] 
/usr/share/nmap/scripts/snmp-win32-software.nse         Attempts to enumerate installed software through SNMP.]] 
/usr/share/nmap/scripts/snmp-win32-users.nse    Attempts to enumerate Windows user accounts through SNMP]]
```

## OneSixtyOne scan

Site: http://www.phreedom.org/software/onesixtyone/

> onesixtyone is an SNMP scanner which utilizes a sweep technique to achieve very high performance. It can scan an entire class B network in under 13 minutes. It can be used to discover devices responding to well-known community names or to mount a dictionary attack against one or more SNMP devices.

```sh
┌──(grenierdev㉿kali)-[~]
└─$ echo 'public' > community

┌──(grenierdev㉿kali)-[~]
└─$ echo 'private' >> community

┌──(grenierdev㉿kali)-[~]
└─$ echo 'manager' >> community

┌──(grenierdev㉿kali)-[~]
└─$ onesixtyone -c community -i snmphosts | tee snmphosts161
Scanning 14 hosts, 4 communities
10.11.1.115 [public] Linux tophat.acme.com 2.4.20-8 #1 Thu Mar 13 17:54:28 EST 2003 i686
10.11.1.227 [public] Hardware: x86 Family 15 Model 1 Stepping 2 AT/AT COMPATIBLE - Software: Windows 2000 Version 5.0 (Build 2195 Uniprocessor Free)
```

## SNMP check

Site: http://www.nothink.org/codes/snmpcheck/index.php

> Snmpcheck is an open source tool distributed under GPL license. Its goal is to automate the process of gathering information of any devices with SNMP protocol support (Windows, Unix-like, network appliances, printers...). Like to snmpwalk, snmpcheck allows you to enumerate the SNMP devices and places the output in a very human readable friendly format. It could be useful for penetration testing or systems monitoring.

```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmp-check 10.11.1.227 -c public
snmp-check v1.9 - SNMP enumerator
Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)

[+] Try to connect to 10.11.1.227:161 using SNMPv1 and community 'public'

[*] System information:

  Host IP address               : 10.11.1.227
  Hostname                      : JD
  Description                   : Hardware: x86 Family 15 Model 1 Stepping 2 AT/AT COMPATIBLE - Software: Windows 2000 Version 5.0 (Build 2195 Uniprocessor Free)
  Contact                       : -
  Location                      : -
  Uptime snmp                   : 1 day, 01:31:37.96
  Uptime system                 : 02:32:53.46
  System date                   : 2022-3-16 17:26:09.1
  Domain                        : WORKGROUP

[*] User accounts:

  lee                 
  ned                 
  gary                
  john                
  lisa
...
```

## SNMP Walk

> snmpwalk is an SNMP application that uses SNMP GETNEXT requests to query a network entity for a tree of information.

```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmpwalk -c public -v1 -t 10 10.11.1.115
iso.3.6.1.2.1.1.1.0 = STRING: "Linux tophat.acme.com 2.4.20-8 #1 Thu Mar 13 17:54:28 EST 2003 i686"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
iso.3.6.1.2.1.1.3.0 = Timeticks: (15187725) 1 day, 18:11:17.25
iso.3.6.1.2.1.1.4.0 = STRING: "Root <root@localhost> (configure /etc/snmp/snmp.local.conf)"
iso.3.6.1.2.1.1.5.0 = STRING: "tophat.acme.com"
iso.3.6.1.2.1.1.6.0 = STRING: "Unknown (edit /etc/snmp/snmpd.conf)"
iso.3.6.1.2.1.1.8.0 = Timeticks: (1) 0:00:00.01
...
```

### Enumerating Windows users
```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmpwalk -c public -v1 -t 10 10.11.1.14 1.3.6.1.4.1.77.1.2.25
iso.3.6.1.4.1.77.1.2.25.1.1.3.98.111.98 = STRING: "bob"
iso.3.6.1.4.1.77.1.2.25.1.1.5.71.117.101.115.116 = STRING: "Guest"
iso.3.6.1.4.1.77.1.2.25.1.1.8.73.85.83.82.95.66.79.66 = STRING: "IUSR_BOB"
```

### Enumerating Windows process
```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmpwalk -c public -v1 -t 10 10.11.1.73 1.3.6.1.2.1.25.4.2.1.2
iso.3.6.1.2.1.25.4.2.1.2.1 = STRING: "System Idle Process"
iso.3.6.1.2.1.25.4.2.1.2.4 = STRING: "System"
iso.3.6.1.2.1.25.4.2.1.2.224 = STRING: "smss.exe"
iso.3.6.1.2.1.25.4.2.1.2.324 = STRING: "csrss.exe"
iso.3.6.1.2.1.25.4.2.1.2.364 = STRING: "wininit.exe"
iso.3.6.1.2.1.25.4.2.1.2.372 = STRING: "csrss.exe"
iso.3.6.1.2.1.25.4.2.1.2.420 = STRING: "winlogon.exe"
iso.3.6.1.2.1.25.4.2.1.2.448 = STRING: "services.exe"
iso.3.6.1.2.1.25.4.2.1.2.480 = STRING: "lsass.exe"
iso.3.6.1.2.1.25.4.2.1.2.488 = STRING: "lsm.exe"
...
```

### Enumerating open TCP ports
```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmpwalk -c public -v1 -t 10 10.11.1.14 1.3.6.1.2.1.6.13.1.3
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.21.0.0.0.0.18646 = INTEGER: 21
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.80.0.0.0.0.45310 = INTEGER: 80
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.135.0.0.0.0.24806 = INTEGER: 135
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.443.0.0.0.0.45070 = INTEGER: 443
...
```

### Enumerating installed software
```sh
┌──(grenierdev㉿kali)-[~/Documents]
└─$ snmpwalk -c public -v1 -t 10 10.11.1.50 1.3.6.1.2.1.25.6.3.1.2
iso.3.6.1.2.1.25.6.3.1.2.1 = STRING: "LiveUpdate 3.3 (Symantec Corporation)"
iso.3.6.1.2.1.25.6.3.1.2.2 = STRING: "WampServer 2.5"
iso.3.6.1.2.1.25.6.3.1.2.3 = STRING: "VMware Tools"
iso.3.6.1.2.1.25.6.3.1.2.4 = STRING: "Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.4148"
iso.3.6.1.2.1.25.6.3.1.2.5 = STRING: "Microsoft Visual C++ 2012 Redistributable (x86) - 11.0.61030"
...
```