<h1 align="center">Pentest Hero</h1>

This document reads as a choose your own adventure book. Each section will leads you to other, and you are expected to backtrack.

Let's begin!

<br>
<br>

# Got yourself a new network

You found a new network or domain. Good for you. Let's find more about the network.

Read more:

- [Domain WHOIS](./Techniques/NetworkScan.md#whois-information)
- [SSL certificate inspection](./Techniques/OpenSSL.md#ssl-debug)
- [Host scan](./Techniques/NetworkScan.md#host-discovery)
- [Subdomain scan](./Techniques/NetworkScan.md#vhost-discovery)

> **Takes Notes**<br>Hosts, names, emails, domains & subdomains, name pattern

Next:

- [Port enumeration](#port-enumeration)

# Port enumeration

Launch a port scan on the target. Be torough. Make use of multiple scan so that you can go interactive before full scan is complete.

Read more:

- [Port discovery](./Techniques/NetworkScan.md#port-discovery)
- [Service discovery](./Techniques/NetworkScan.md#service-discovery)
- [Banner grab](./Techniques/NetworkScan.md#banner-grab-manually)
- [vHost discovery](./Techniques/NetworkScan.md#vhost-discovery)

> **Takes Notes**<br>Ports, service's version, banner version, name pattern

Next:

- Found [HTTP](#website) service (port 80, 443, 8080)
- Found [SMB/Samba](#samba) service (port 139, 445)
- Found [NFS](#NFS) service (port 2049)
- Found [FTP](#FTP) service (port 21)
- Found [SSH](#SSH) service (port 22, 2222, 22222)
- Found [WinRM](#WinRM) service (port 5985, 5986)

# Website

Take your time navigating the website. Read every blog post for clues, inspect every link, forms, image path and javascript code. **Click everywhere**. Use Burp Suite to build a map of the website.

Read more:

- Found form input, try [SQLi](#)
- Found form input, try [bash injection](#)
- Found form input, try [SSTI](./Techniques/SSTI.md)
- Found form input, try [XXE](./Techniques/XXE.md)
- Found login form, try [brute force with known users](./Techniques/BruteForce.md#hydra-http)
- Build a wordlist with [CeWL](./Tools/CeWL.md)
- Crawl resources with [FFuF](./Tools/ffuf.md) or [Feroxbuster](./Tools/Feroxbuster.md), use FFuF's replay proxy to forward interesting resource to Burp
- Crawl known dangerous file with [Nikto](./Tools/Nikto.md)
- [WordPress scan](./Tools/wpscan.md)

> **Takes Notes**<br>Names, emails, blog posts, links, forms, image/css/js path and code

Next:

- [Webshell](#mi-casa-su-casa)
- Local/Remote [File inclusion](#)
- [Confirm connectivity](./Techniques/NetworkSniffing.md) with your box

# SMB

Nice a SMB or Samba service. You might have hit the jackpot!

> **IMPORTANT** when searching for vulnerability, SMB and SAMBA are not the same thing!

Read more:

- Auto enumerate with [enum4linux](./Tools/enum4linux.md)
- Use nmap script, their free!
- Use [smbclient and rpcclient](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb) with blank username/password, with no-password or with known credentials

> **Takes Notes**<br>Users, SID, shares and their description

Next:

- smbexec and [gain shell](#mi-casa-su-casa)
- Enumerate shares
- [Symlink directory traversal](https://github.com/roughiz/Symlink-Directory-Traversal-smb-manually)
- [Brute force](./Techniques/BruteForce.md#hydra-smb) with known users

# NFS

Quick, mount any share locally you might get lucky!

Read more:

- Enumerate share
- Service probably is misconfigured without `no_root_squash` or `all_squash` and you can probably spoof permission with local UID/GID users.

Next:

- Enumerate files
- [Brute force](./Techniques/BruteForce.md#hydra-nfs) with known users

# WinRM

Next:

- [Gain shell](#mi-casa-su-casa)

# SSH

Once you got some creds, you'll get a stable shell here! Find those credentials or private keys!

Read more:

- Interesting paths
	- `/home/*/.ssh/id_rsa`
	- `/home/*/.ssh/authorized_hosts`
	- `/etc/ssh/sshd_config`
- [OpenSSH 2.3 < 7.7 user enumeration](https://www.exploit-db.com/exploits/45233)
- Tunnel and pivot

Next:

- [Connect](#mi-casa-su-casa) using credentials
- Establish tunnel/pivot
- [Brute force](./Techniques/BruteForce.md#hydra-ssh) known users

# Mi casa, su casa

So you got a shell? Find that user.txt!

Read more:

- Stabilize shell
- Migrate to other process or file
- Know your host
- Know who you are, what you can access/execute/start/stop
- Are there other users? Can you access their stuff? Their history?
- Is there anyone connected with you?
- Inspect short-lived process with [pspy](./Tools/pspy.md) for clues
- Inspect running service, you might catch more service that aren't exposed externally
- What files has changes recently?

> **Takes Notes**<br>Users account, services

Next:

- Run winPEAS/linPEAS to enumerate the host
- Establish tunnel for better service enumeration with chisel or plink
- [Active Directory/LDAP](#ldap-enumeration) enumeration

# LDAP Enumeration

Read more:

- Python `ldap3` [package enumeration](https://book.hacktricks.xyz/network-services-pentesting/pentesting-ldap#manual)
- Nmap script enumeration
- Use [ldapsearch](https://book.hacktricks.xyz/network-services-pentesting/pentesting-ldap#manual)
- Use [adsisearch](#) to enumerate users, computers, services, [LAPS password](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#extract-laps-password)
- Use [PowerView](./Tools/PowerView.md)

# AV is annoyingly blocking your payload?

Next:

- Powershell PE Reflective Injection with [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1)
- Shellter
- MSF Venom more iteration